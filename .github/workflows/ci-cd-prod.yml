name: Node Build
	on:
 	  push:
 	    branches:
 	      [master]
 	  pull_request:
 	    branches:
 	      [master]

 	jobs:
 	  build:
 	    runs-on: ubuntu-latest
 	    strategy:
 	      matrix:
 	        node-version: [12.x]

 	    steps:
 	      - uses: actions/checkout@v1
 	      - name: Cache node modules
 	        uses: actions/cache@v1
 	        with:
 	          path: ~/.npm
 	          key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
 	          restore-keys: |
 	            ${{ runner.os }}-node-
 	      - name: Node ${{ matrix.node-version }}
 	        uses: actions/setup-node@v1
 	        with:
 	          node-version: ${{ matrix.node-version }}
 	      - name: Cypress tests
 	        run: |
 	          npm install
 	          npm test
 	          npm ci
        - name: Add remote origin
            run: git remote add heroku https://heroku:${{ secrets.HEROKU_API_KEY }}@git.heroku.com/plannic.git
        - name: Deploy backend to heroku
            run: git push --force heroku `git subtree split --prefix server HEAD`:master
